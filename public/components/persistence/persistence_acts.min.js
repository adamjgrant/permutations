m.persistence.acts({save_code(t,e){return localStorage.setObject("document_id",t.act.get_document_id()),localStorage.setObject("code",m.editor.act.get_value())},load_code(t,e){return localStorage.getObject("code")},set_initial_state(t,e){t.act.load_code().length?m.editor.act.set_value({value:t.act.load_code()}):m.editor.act.set_default_text()},get_document_id(t,e){const o=t.act.find_document_id_from_url(),n=t.act.get_id_from_localstorage();if(!o&&!n){const e=t.act.generate_a_new_document_id();return t.act.save_id_to_localstorage({document_id:e}),t.act.save_to_file({data:m.editor.act.get_value()}),e}if(!o&&n)return history.replaceState(null,n,`/${n}`),n},priv:{load_from_file(t,e){var o=new XMLHttpRequest;o.open("GET",`/document/${t.act.get_document_id()}`,!0),o.onload=function(){return this.status>=200&&this.status<400?this.response:void console.error("Could not load URL")},o.onerror=function(){console.error("Could not load URL")},o.send()},save_to_file(t,e){var o=new XMLHttpRequest;o.open("POST",`/document/${t.act.get_document_id()}`,!0),o.setRequestHeader("Content-Type","application/json"),o.send(e.data)},find_document_id_from_url(t,e){},generate_a_new_document_id(t,e){return parseInt(`${Math.floor(1e3*Math.random())}${Date.now()}`).toString(36)},get_id_from_localstorage(t,e){return localStorage.getItem("document_id")},save_id_to_localstorage(t,e){return localStorage.setItem("document_id",e.document_id)}}});