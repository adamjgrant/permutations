const default_text=`{
    "main": [
      "Hey there", "Well hello", "Greetings", [
        ". ", [
          "Permy.link", "This permutation generator", [
            " ", [
              "lets you make many \\"permutations\\" of a line of text using specified variations.", {
                "branch": "keep reading"
              }
            ]
          ]
        ]
      ]
    ],
    "keep reading": [
      " ", [
        "Permy has some neat advanced features for keeping your configuration", { "branch": "tidy", "then":  ["too. ", { "branch": "about branches" }] }
      ]
    ],
    "tidy": [" ", ["tidy", "organized", "neat and streamlined", [" "]]],
    "about branches": [
      "You can create branches", "Branches can be created", { "branch": "why do you create branches?" }
    ],
    "why do you create branches?": [
      " which let you converge separate paths or just create named shortcuts. ", [
        "Learn more", "Read on", [
          " about", [
            " permy.link by clicking on the docs link below.", {
              "branch": "smiley"
            }
          ]
        ]
      ]
    ],
    "smiley": ["ðŸ¤“", "ðŸ˜", "ðŸ˜€"]
}`,editor=CodeMirror.fromTextArea(document.getElementById("code"),{matchBrackets:!0,autoCloseBrackets:!0,mode:"application/ld+json",lineWrapping:!0,lineNumbers:!0,theme:"solarized dark"}),output_element=document.getElementById("output"),Permute=module.exports;let last_permutation;editor.on("change",(e,t)=>{setOutput("Permuting..."),debounce(permute,"editor",500),debounce(persist,"persistence",500)});const permute=()=>{let e="Error parsing JSON";try{let t=[];for(;t.length<5;)t.push(random_permutation());e=t.map(e=>`<li>${e}</li>`).join(""),last_permutation=t,setOutput(e)}catch(t){setOutput(`${e}: ${t}`)}},random_permutation=()=>{return new Permute(JSON.parse(editor.getValue()),!0).permutations[0]},persist=()=>{localStorage.setObject("code",editor.getValue())},random_action_element=document.getElementById("random"),regenerate_action_element=document.getElementById("regenerate");random_action_element.addEventListener("click",()=>{if(!last_permutation)return alert("Please generate a permutation first");const e=random_permutation();return show_flash(`Copied to clipboard: "${e}"`),navigator.clipboard.writeText(e)}),regenerate_action_element.addEventListener("click",()=>{permute()});const flash_element=document.getElementById("flash");let flash_timeout;const show_flash=e=>{window.clearTimeout(flash_timeout),flash_element.innerHTML=e,flash_element.classList.add("show"),flash_timeout=window.setTimeout(()=>{flash_element.classList.remove("show")},2e3)},setOutput=e=>output_element.innerHTML=e;document.getElementById("clear").addEventListener("click",()=>{confirm("You will lose anything you've entered, are you sure?")&&editor.setValue(`{ 
  "main": [] 
}
    `)});const default_button=document.getElementById("default"),set_default_text=()=>{editor.setValue(default_text)};default_button.addEventListener("click",()=>{confirm("You will lose anything you've entered, are you sure?")&&set_default_text()});const gist_url_element=document.getElementById("gist_url");permute();const previous_code=localStorage.getObject("code");previous_code?editor.setValue(previous_code):set_default_text();